---
title: "Bolivia"
output: 
  html_document:
    toc: true
    toc_float: true
    toc_collapsed: true
    toc_depth: 6
    theme: darkly
---

```{r warning = FALSE, include=FALSE}
library(dygraphs)
library(tidyverse)
library(zoo)
library(rio)
library(tidyverse)
library(magrittr)
library(janitor)
library(anytime)
library(knitr)
library(details)

dyCrosshair <- function(dygraph, 
                        direction = c("both", "horizontal", "vertical")) {
  dyPlugin(
    dygraph = dygraph,
    name = "Crosshair",
    path = system.file("plugins/crosshair.js", 
                       package = "dygraphs"),
    options = list(direction = match.arg(direction))
  )
}
fun_fecha <-function(from, to, by, each) {
  rep(seq(anydate(from),
          anydate(to),
          by = by), each = each)
}
fun_excel <-function(file, range, col_names, from, to, by, each) {
  
  data <- 
    rio::import(
      file,
      setclass = "tbl_df",
      range = range,
      col_names = col_names,
      .name_repair = "unique_quiet") %!>%
    remove_empty(c("rows", "cols")) %!>%
    replace(is.na(.), 0)
  data %<>%
    pivot_longer(!...1) %<>%
    pivot_wider(names_from = "...1",
                values_from = "value") %<>%
    dplyr::select(-name)
  
  fecha <- fun_fecha(from,to,by,each)
  data <- cbind(fecha, data) 
  data <- as_tibble(data)
  
}

file <- "C:/Users/Mauro/Desktop/bases_de_datos/bolivia/ine/estadistica_economica/cuentas_nacionales/pib_anual/oferta_final_demanda_final/03.01.02.xlsx"

#IMPORTAR DATOS DE EXCEL
range <- "B12:AJ19"
col_names <- FALSE
#FORMATO FECHA
from <- "31Dec1989"
to <- "31Dec2022"
by <- "year"
each <- 1

excel <- 
  fun_excel(file, range, col_names, from, to, by, each)

excel %!>% 
  read.zoo(excel, FUN = as.yearmon) %!>% 
  as.ts(excel)

pib <- excel %!>% 
  select(fecha, `PRODUCTO  INTERNO  BRUTO`) #PIB

file <- "C:/Users/Mauro/Desktop/bases_de_datos/bolivia/ine/estadistica_economica/cuentas_nacionales/pib_anual/serie_historica_pib/06.01.02.xlsx"

#IMPORTAR DATOS DE EXCEL
range <- "B12:AS54"
col_names <- FALSE
#FORMATO FECHA
from <- "31Dec1980"
to <- "31Dec2022"
by <- "year"
each <- 1

excel2 <- 
  fun_excel(file, range, col_names, from, to, by, each)

excel2 %!>% 
  read.zoo(excel2, FUN = as.yearmon) %!>% 
  as.ts(excel2)

pib2 <- excel2 %!>% 
  select(fecha, 
         `Derechos S/Importaciones, IVA n.d., IT y otros Impuestos Indirectos`,
         `1. AGRICULTURA, SILVICULTURA, CAZA Y PESCA`,
         `2. EXTRACCIÓN DE MINAS Y CANTERAS`, 
         `3. INDUSTRIAS  MANUFACTURERAS`, 
         `4. ELECTRICIDAD GAS Y AGUA` ,
         `5. CONSTRUCCIÓN`,
         `6. COMERCIO`,
         `7. TRANSPORTE, ALMACENAMIENTO Y COMUNICACIONES`,
         `INMUEBLES Y SERVICIOS PRESTADOS A LAS EMPRESAS`,
         `9. SERVICIOS COMUNALES, SOCIALES Y PERSONALES`,
         `10. RESTAURANTES Y HOTELES`,
         `SERVICIOS BANCARIOS IMPUTADOS`,
         `B. SERVICIOS DE LA ADMINISTRACION PÚBLICA`,
         `C. SERVICIO DOMESTICO`) %!>% 
  mutate(across(where(is.numeric),  ~ . / 1000))

file <- "C:/Users/Mauro/Desktop/bases_de_datos/bolivia/ine/estadistica_economica/cuentas_nacionales/pib_anual/serie_historica_pib/06.01.04.xlsx"

#IMPORTAR DATOS DE EXCEL
range <- "B12:AS19"
col_names <- FALSE
#FORMATO FECHA
from <- "31Dec1980"
to <- "31Dec2022"
by <- "year"
each <- 1

excel3 <- 
  fun_excel(file, range, col_names, from, to, by, each)

excel3 %!>% 
  read.zoo(excel3, FUN = as.yearmon) %!>% 
  as.ts(excel3)

pib3 <- excel3 %!>% 
  select(fecha, 
         `GASTO DE CONSUMO FINAL DE LA ADMINISTRACIÓN  PÚBLICA`,
         `GASTO DE CONSUMO FINAL DE LOS HOGARES  E  ISFLSH`, 
         `VARIACIÓN  DE  EXISTENCIAS`, 
         `FORMACIÓN  BRUTA  DE  CAPITAL  FIJO` ,
         `EXPORTACIONES  NETAS DE BIENES Y SERVICIOS`) %!>% 
  mutate(across(where(is.numeric),  ~ . / 1000))

knitr::opts_chunk$set(echo = TRUE, error = TRUE)
```

# Autoridad de Supervisión del Sistema Financiero (ASFI) 

## Indicadores Financieros {.tabset .tabset-pills}

### Estructura de Activos

```{r knitr-activos, out.width='100%', echo=FALSE}
knitr::include_graphics("/images/asfi/activos/Cartera Neta_Activo.png", error = FALSE)
knitr::include_graphics("/images/asfi/activos/Disponibilidades_Activos.png", error = FALSE)
```

### Estructura Financiera

```{r knitr-esfinanciera, out.width='100%', echo=FALSE}
knitr::include_graphics("/images/asfi/esfinanciera/Activo improductivo_Patrimonio.png", error = FALSE)
knitr::include_graphics("/images/asfi/esfinanciera/Activo Productivo_Activo+Contingente.png", error = FALSE)
knitr::include_graphics("/images/asfi/esfinanciera/Activo Productivo-Pasivo con Costo_Pasivo con Costo.png", error = FALSE)
knitr::include_graphics("/images/asfi/esfinanciera/Pasivo con Costo_Pasivo+Contingente.png", error = FALSE )
```

### Estructura de Gastos de Administración

```{r knitr-gastos, out.width='100%', echo=FALSE}
knitr::include_graphics("/images/asfi/gastos/Deprec.y Amortizaciones_Gastos de Administración.png", error = FALSE)
knitr::include_graphics("/images/asfi/gastos/Gastos de Administración_Total Egresos.png", error = FALSE)
knitr::include_graphics("/images/asfi/gastos/Gastos de Personal_Gastos de Administración.png", error = FALSE)
knitr::include_graphics("/images/asfi/gastos/Otros Gastos Administración_Gastos de Administración.png", error = FALSE)
```


### Including Plots2
```{r }
library(dygraphs)
lungDeaths <- cbind(mdeaths, fdeaths)
dygraph(lungDeaths)
```

#### Including Plots3 {.tabset .tabset-pills}
```{r }
library(dygraphs)
lungDeaths <- cbind(mdeaths, fdeaths)
dygraph(lungDeaths)
```

##### By Product

(tab content)

##### By Region

2

# Banco Central de Bolivia (BCB)

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars2}
summary(cars)
```


# Instituto Nacional de Estadística (INE)

<div class="container-sm">
```{r dygraph1,fig.width= 5, fig.height= 3.5, echo=FALSE, warning = FALSE}

dygraph(pib, main = "Crecimiento Real Producto Interno Bruto<br><small>En Porcentaje (%)</small>") %!>% 
  dySeries("PRODUCTO  INTERNO  BRUTO", label = "Producto Interno Bruto") %!>% 
  dyLegend(show = "onmouseover") %!>% 
  dyOptions(stackedGraph = TRUE, axisLineColor = "#98918B") %!>%
  dyAxis("x", drawGrid = FALSE) %>%
  dyAxis("y",
       gridLineColor = "#4a4a4a",
         valueFormatter = "function(d){return Math.round(d*100)/1e2 + '%'}",
         axisLabelFormatter = "function(d){return Math.round(d*100)/1e2 + '%'}") %!>% 
  dyCrosshair(direction = "vertical") %!>% 
  dyRangeSelector(height = 30) %!>% 
  dyHighlight(highlightCircleSize = 1,
              highlightSeriesBackgroundAlpha = 1) 
```
</div>
<div class="container-sm">
<div class="row">
<div class="col-lg-6">
```{r dygraph2,fig.width= 5, fig.height= 3.5, echo=FALSE, warning = FALSE}

dygraph(pib2, main = "Producto Interno Bruto según Actividad Económica<br><small>(En Millones de Bs)</small>") %!>% 
  dySeries("Derechos S/Importaciones, IVA n.d., IT y otros Impuestos Indirectos", 
           label = "Impuestos Indirectos") %!>% 
  dySeries("1. AGRICULTURA, SILVICULTURA, CAZA Y PESCA", 
           label = "Agricultura, Silvicultura, Caza y Pesca") %!>% 
  dySeries("2. EXTRACCIÓN DE MINAS Y CANTERAS", 
           label = "Extracción Minas y Canteras") %!>% 
  dySeries("3. INDUSTRIAS  MANUFACTURERAS", 
           label = "Industrias Manufactureras") %!>% 
  dySeries("4. ELECTRICIDAD GAS Y AGUA", 
           label = "Electricidad Gas y Agua") %!>% 
  dySeries("5. CONSTRUCCIÓN", 
           label = "Construcción") %!>% 
  dySeries("6. COMERCIO", 
           label = "Comercio") %!>% 
  dySeries("7. TRANSPORTE, ALMACENAMIENTO Y COMUNICACIONES", 
           label = "Transporte, Almacenamiento y Comunicaciones") %!>% 
  dySeries("INMUEBLES Y SERVICIOS PRESTADOS A LAS EMPRESAS", 
           label = "Establecimientos Financieros, Seguros, Bienes Inmuebles y Servicios Prestados a las Empresas") %!>% 
  dySeries("9. SERVICIOS COMUNALES, SOCIALES Y PERSONALES", 
           label = "Servicios Comunales, Sociales y Personales") %!>% 
  dySeries("10. RESTAURANTES Y HOTELES", 
           label = "Restaurantes y Hoteles") %!>% 
  dySeries("SERVICIOS BANCARIOS IMPUTADOS", 
           label = "Servicios Bancarios Imputados") %!>% 
  dySeries("B. SERVICIOS DE LA ADMINISTRACION PÚBLICA", 
           label = "Servicios de la Administración Pública") %!>% 
  dySeries("C. SERVICIO DOMESTICO", 
           label = "Servicio Doméstico") %!>% 
  dyLegend(show = "onmouseover", labelsDiv = "labels2", labelsSeparateLines = TRUE) %!>% 
  dyOptions(stackedGraph = TRUE, axisLineColor = "#98918B") %!>%
  dyAxis("x", drawGrid = FALSE) %>%
  dyAxis("y",
        valueRange = c(-50000,305000),
       gridLineColor = "#4a4a4a",
         valueFormatter = 'function(d){return Math.round(d).toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ",");}',
         axisLabelFormatter = 'function(d){return d.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ",");}'
         ) %!>% 
  dyCrosshair(direction = "vertical") %!>% 
  dyRangeSelector(height = 30) %!>% 
  dyHighlight(highlightCircleSize = 1,
              highlightSeriesBackgroundAlpha = 1) 
```
<div id="labels2" style="color: #e3e3e3;"></div>
</div>
<div class="col-lg-6">
```{r dygraph3,fig.width= 5, fig.height= 3.5, echo=FALSE, warning = FALSE}

dygraph(pib3, main = "Producto Interno Bruto según Tipo de Gasto<br><small>(En Millones de Bs)</small>") %!>% 
  dySeries("GASTO DE CONSUMO FINAL DE LA ADMINISTRACIÓN  PÚBLICA", 
           label = "Gasto Administración Pública") %!>% 
  dySeries("GASTO DE CONSUMO FINAL DE LOS HOGARES  E  ISFLSH", 
           label = "Gasto Hogares e ISFLSH") %!>% 
  dySeries("VARIACIÓN  DE  EXISTENCIAS", 
           label = "Variación de Existencias") %!>% 
  dySeries("FORMACIÓN  BRUTA  DE  CAPITAL  FIJO", 
           label = "Formación Bruta de Capital Fijo") %!>% 
  dySeries("EXPORTACIONES  NETAS DE BIENES Y SERVICIOS", 
           label = "Exportaciones Netas de Bienes y Servicios")  %!>% 
  dyLegend(show = "onmouseover", labelsDiv = "labels3", labelsSeparateLines = TRUE) %!>% 
  dyOptions(stackedGraph = TRUE, axisLineColor = "#98918B") %!>%
  dyAxis("x", drawGrid = FALSE) %>%
  dyAxis("y",
         valueRange = c(-50000,305000),
         gridLineColor = "#4a4a4a",
         valueFormatter = 'function(d){return Math.round(d).toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ",");}',
         axisLabelFormatter = 'function(d){return d.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ",");}'
  ) %!>% 
  dyCrosshair(direction = "vertical") %!>% 
  dyRangeSelector(height = 30) %!>% 
  dyHighlight(highlightCircleSize = 1,
              highlightSeriesBackgroundAlpha = 1) 
```
<div id="labels3" style="color: #e3e3e3;"></div>
</div>
</div>
</div>

## Including Plots1

You can also embed plots, for example:

```{r pressure3, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

### Including Plots2

```{r }
library(dygraphs)
lungDeaths <- cbind(mdeaths, fdeaths)
dygraph(lungDeaths)
```

# Ministerio de Economía y Finanzas públicas (MEFP)

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars4}
summary(cars)
```

## Including Plots1

You can also embed plots, for example:

```{r pressure4, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

### Including Plots2

```{r }
library(dygraphs)
lungDeaths <- cbind(mdeaths, fdeaths)
dygraph(lungDeaths)
```

# Unidad de Análisis de Políticas Sociales y Económicas (UDAPE)

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars5}
summary(cars)
```

## Including Plots1

You can also embed plots, for example:

```{r pressure5, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

### Including Plots2

```{r }
library(dygraphs)
lungDeaths <- cbind(mdeaths, fdeaths)
dygraph(lungDeaths)
```


```{css, echo=FALSE}
.container-fluid.main-container{
max-width: 85%
}
.tabset{
    display: flex;

}

.nav.nav-pills {
    flex: 15%;
    width: 100%;
}
.nav.nav-pills li{
    width: 100%;
}
.tab-content{
    flex: 85%;
    width: 100%
}

```


## {.tabset .tabset-pills .tabcontent}


### Section 1

Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.


### Section 2

Ut porttitor leo a diam. Auctor neque vitae tempus quam pellentesque nec nam.